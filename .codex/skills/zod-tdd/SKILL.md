---
name: zod-tdd
description: zod-app 백엔드에서 테스트 주도 개발(TDD)을 수행할 때 사용한다. Kotlin/JUnit5/Mockito를 사용하며, red-green-refactor 흐름과 레포 AGENTS 규칙을 따른다.
---

# Zod TDD (Backend)

이 스킬은 zod-app 백엔드에서 테스트 우선 개발을 진행할 때 사용한다.

## 입력 확인

- 기본 입력은 `./.codex/task` 아래의 태스크 작업 문서다.
- 파일 경로가 주어지지 않으면, 가장 최근에 생성된 태스크 작업 문서를 찾거나 사용자에게 물어보라.
- 레거시 참고: `/home/routine/workspace/zod-app/app-old`
- 레거시 참고 코드가 있으면 반드시 확인하고 구현에 참고하라.


## 범위

- 레포: `/home/routine/workspace/zod-app/app`
- 언어/스택: Kotlin + JUnit5 + Mockito
- 설계 규칙: 레포 `AGENTS.md` 및 `app/AGENTS.md`를 반드시 준수한다.

## 진행 흐름 (Red → Green → Refactor)

1. **범위 확인**: 기대 동작, 입력/출력, 대상 레이어(api/application/domain/infra)를 **질문은 한 번에 하나씩** 확인한다. 답변을 받은 뒤 다음 질문을 한다.
2. **Red**: 테스트를 먼저 추가/수정한다.
   - 테스트는 `src/test/kotlin` 아래에 패키지 구조를 맞춰 배치한다.
   - Mockito로 목(mock) 처리, JUnit5 assertions를 사용한다.
3. **Green**: 테스트를 통과시키는 최소한의 코드를 구현한다.
4. **Refactor**: 테스트를 유지하면서 정리한다.

## 규칙

- 동작당 테스트는 작고 명확하게 유지한다.
- 기존 테스트가 한글 이름을 사용한다면 테스트 이름도 한글로 맞춘다.
- 명시적 요청이 없으면 광범위한 리팩토링은 하지 않는다.
- 코드/파일 생성이 필요할 때는 **처음 한 번만** 생성 여부를 묻고, 사용자가 생성하라고 하면 필요한 작업을 한 번에 진행한다.

## 산출물 저장

- 산출물은 반드시 `./.codex/tdd` 아래에 Markdown으로 저장하라.
- 파일명은 태스크 작업 문서명에 `-tdd`를 붙여 생성하라.

## 질문이 필요한 경우

- 기대 동작이 불명확하면 테스트 작성 전에 질문한다.
- 레이어 경계가 모호하면 먼저 확인한다.
- 요구사항이 불명확하면 항상 한 번에 하나씩 질문한다.

## 산출물 저장

- 산출물은 반드시 `./.codex/tdd` 아래에 Markdown으로 저장하라.
- 파일명은 태스크 작업 문서명에 `-tdd`를 붙여 생성하라.
- 산출물에는 질문/답변 히스토리를 남기고, 최종 테스트가 완료되면 히스토리를 정리해 중복을 제거한 뒤 최종 산출물을 기록하라.
